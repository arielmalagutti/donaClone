<div class="w-full h-full pt-9 flex flex-col items-center">
  <div class="max-w-[664px] w-full h-full flex flex-col gap-5">
    <div
      [ngClass]="{ 'bg-white px-2 py-2 shadow-sm': isEditing }"
      class="w-full h-full max-h-11 relative gap-3 flex items-center rounded-xl"
    >
      <app-icon-picker *ngIf="isEditing"></app-icon-picker>
      <i
        *ngIf="todoList?.icon?.includes('ph') && !isEditing"
        [ngClass]="todoList?.icon"
        class="ph-bold text-xl dark:text-white"
      ></i>
      <app-dona-svg
        *ngIf="todoList?.icon?.includes('dona') && !isEditing"
        [ngClass]="[todoList?.icon, !isEditing ? 'opacity-100' : '']"
        twClasses="h-7"
        class="opacity-0 transition-opacity duration-500"
      ></app-dona-svg>

      <div class="w-full group flex items-center gap-2">
        <input
          #listNameEditorInput
          *ngIf="this.isEditing"
          [value]="this.todoList?.name"
          type="text"
          placeholder="Insert a new name for this list"
          (blur)="this.isEditing = false"
          (keyup.escape)="this.isEditing = false"
          (keyup.enter)="this.handleEditList(listNameEditorInput)"
          class="flex bg-transparent placeholder:text-base text-xl font-medium text-[#25292C] outline-none"
        />
        <h1
          *ngIf="!this.isEditing"
          class="flex text-xl font-medium text-[#25292C] dark:text-zinc-50 text-ellipsis"
        >
          {{ this.todoList?.name }}
        </h1>

        <div class="relative">
          <button
            *ngIf="!isEditing"
            title="Actions"
            type="button"
            (click)="openDropdown()"
            [ngClass]="{ 'opacity-100 -translate-x-0': isActionsOpen }"
            class="w-8 h-8 translate-x-1 opacity-0 flex items-center justify-center p-1 rounded-lg group-hover:opacity-100 hover:bg-[#FFFFFF50] group-hover:translate-x-0 transition-all duration-300"
          >
            <i class="ph-bold ph-dots-three-vertical text-lg"></i>
          </button>

          <div
            *ngIf="isActionsOpen"
            appDropdown
            (dropdownVisible)="closeDropdown($event)"
            [ngClass]="{ 'opacity-100': isActionsOpen }"
            class="opacity-0 max-w-[148px] w-[148px] absolute z-10 top-9 left-0 flex flex-col p-1 gap-1 bg-white rounded-[11px] shadow transition-opacity duration-1000"
          >
            <app-actions-dropdown
              (onEdit)="this.isEditing = true; this.isActionsOpen = false"
            ></app-actions-dropdown>
          </div>
        </div>
      </div>
    </div>

    <div class="w-full h-full flex flex-col pl-11 pr-2 gap-6 overflow-y-auto">
      <div
        [ngClass]="{
          'bg-white dark:bg-[#2f343d] dark:shadow-addTodoBar': isCreatingTodo
        }"
        class="group relative w-full pr-6 py-3 gap-3 flex items-center bg-[#E0E0E6] dark:bg-addTodoBar-dark rounded-xl shadow transition-all duration-500"
      >
        <input
          #fakeCheckbox
          disabled
          [ngClass]="{ 'opacity-100 left-6': isCreatingTodo }"
          type="checkbox"
          class="w-5 h-5 absolute left-0 opacity-0 bg-[#e9ecef] dark:bg-checkbox-dark rounded-[7px] appearance-none cursor-not-allowed focus:outline-none transition-all duration-300"
        />

        <input
          #addTodoInput
          [ngClass]="{ 'pl-[56px]': isCreatingTodo }"
          class="w-full pl-6 bg-transparent dark:text-white outline-none group-focus:bg-white dark:caret-white transition-all duration-300"
          type="text"
          (click)="isCreatingTodo = true"
          (blur)="onBlur(addTodoInput)"
          (keyup.enter)="onCreateTodo(addTodoInput)"
          placeholder="Write a new task"
        />

        <div
          [ngClass]="{ 'opacity-100': !isCreatingTodo }"
          class="relative opacity-0 flex items-center gap-[3px] transition-opacity duration-300"
        >
          <span
            *ngIf="!isEditing"
            class="w-5 h-5 flex items-center justify-center bg-[#d4d7da] dark:bg-sideBar-itemLength-dark text-[#616870] dark:text-sideBar-itemLength-dark text-xs font-semibold text-center rounded-lg"
          >
            <i class="ph-bold ph-command"></i>
          </span>
          <span
            *ngIf="!isEditing"
            class="w-5 h-5 flex items-center justify-center bg-[#d4d7da] dark:bg-sideBar-itemLength-dark text-[#616870] dark:text-sideBar-itemLength-dark text-xs font-semibold text-center rounded-lg"
          >
            E
          </span>
        </div>
      </div>

      <div
        class="w-full h-full flex flex-col gap-1"
        cdkDropList
        (cdkDropListDropped)="drop($event)"
      >
        <app-todo
          cdkDrag
          *ngFor="
            let todo of todoList?.todos?.reverse();
            let first = first;
            let last = last
          "
          [todo]="todo"
          [firstChild]="first"
          [lastChild]="last"
        ></app-todo>

        <div
          *ngIf="!todoList?.todos?.length"
          class="w-full h-full flex items-center justify-center"
        >
          <span class="text-[#cfd2d5] font-medium -translate-y-[60px]"
            >You're all set
          </span>
        </div>
      </div>
    </div>
  </div>
</div>
